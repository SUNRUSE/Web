function SprigganRemoveByValue(e,t){for(var n=0;n<e.length;n++)if(e[n]==t)return void e.splice(n,1)}function SprigganSetLoadingText(e){var t=document.getElementById("loading");t&&(t.innerText=e)}function SprigganEventOnce(){this.callbacks=[],this.raised=null}function SprigganEventRecurring(){this.callbacks=[],this.oneTimeCallbacks=[]}function SprigganTimer(e,t){this.seconds=e,this.milliseconds=1e3*e,this.configuration=t,this.started=null,this.elapsed=0,this.done=!1,this.timeout=null,this.interval=null}function SprigganContentManager(e){this.completed=0,this.total=0,this.content=[],this.configuration=e,SprigganAllContentManagers.push(this)}function SprigganText(e,t){var n=new XMLHttpRequest;return n.onreadystatechange=function(){if(4==n.readyState){if(!(n.status>=200&&n.status<=299))throw new Error('Failed to download "'+e+'" as text; HTTP status code '+n.status+" was returned");t(n.responseText)}},n.open("GET",e,!0),n.send(),function(){}}function SprigganJson(e,t){return SprigganText(e,function(n){var i;try{i=JSON.parse(n)}catch(o){throw new Error('Failed to parse "'+e+'" as JSON')}t(i)})}function SprigganJavaScript(e,t){return SprigganText(e,function(n){var i;try{i=new Function(n)()}catch(o){throw new Error('Failed to parse "'+e+'" as JavaScript')}t(i)})}function SprigganImage(e,t){var n=new Image;return n.onload=function(){t(n)},n.onerror=function(){throw new Error('Failed to load "'+e+'" as a PNG image')},n.src=e,function(){}}function SprigganSpriteSheet(e,t){function n(){if(i&&o){var e={image:o.cloneNode(!0),sprites:s};if(e.image.style.touchAction="manipulation","imageRendering"in e.image.style)e.image.style.imageRendering="pixelated",e.image.style.imageRendering="-moz-crisp-edges";else if("msInterpolationMode"in e.image.style)e.image.style.msInterpolationMode="nearest-neighbor";else{var n=document.createElement("CANVAS");n.width=4*o.width,n.height=4*o.height;var r=n.getContext("2d");r.msImageSmoothingEnabled=!1,r.drawImage(o,0,0,4*o.width,4*o.height),e.image.src=n.toDataURL("image/png")}e.image.style.position="absolute",e.image.style.width=o.width+"em",e.image.style.height=o.height+"em";var a={};for(var p in i.animations){for(var l=i.animations[p],g=[],h=0;h<l.length;h++){var u=i.frames[l[h]];g.push({imageLeft:-u[0]+"em",imageTop:-u[1]+"em",wrapperWidth:1+u[2]-u[0]+"em",wrapperHeight:1+u[3]-u[1]+"em",wrapperMarginLeft:u[0]-u[4]+"em",wrapperMarginTop:u[1]-u[5]+"em",duration:u[6]})}a[p]=g}e.getAnimationByName=function(e){for(var t in a)if(t==e)return a[t];throw new Error('Animation "'+e+'" does not exist in this SprigganSpriteSheet')},t(e)}}var i,o,r=new SprigganJson(e+".json",function(e){i=e,n()}),a=new SprigganImage(e+".png",function(e){o=e,n()}),s=[];return function(){for(r(),a();s.length;)s[0].dispose()}}function SprigganSound(e,t){var n=!1;if(!SprigganEventWasTriggeredByUserInteraction)throw new Error("Some platforms only support loading audio from a click/touch event");var i;return window.Audio?(i=new Audio,i.onloadeddata=function(){i.onloadeddata=null,i.onerror=null,t(function(){if(n)throw new Error("This SprigganSound has been disposed of");i.currentTime=0,i.play()})},i.onerror=function(){throw i.onloadeddata=null,i.onerror=null,new Error('Failed to download "'+e+'" as a sound')},i.src=e,i.load()):setTimeout(function(){t(function(){if(n)throw new Error("This SprigganSound has been disposed of")})},0),function(){n=!0,i&&i.pause()}}function SprigganMusic(e,t){var n=!1;if(!SprigganEventWasTriggeredByUserInteraction)throw new Error("Some platforms only support loading audio from a click/touch event");var i;return window.Audio?(i=new Audio,i.onloadeddata=function(){i.onloadeddata=null,i.onerror=null,t({play:function(){if(n)throw new Error("This SprigganMusic has been disposed of");i.currentTime=0,i.play()},resume:function(){if(n)throw new Error("This SprigganMusic has been disposed of");i.play()},pause:function(){if(n)throw new Error("This SprigganMusic has been disposed of");i.pause()},stop:function(){if(n)throw new Error("This SprigganMusic has been disposed of");i.pause(),i.currentTime=0}})},i.onerror=function(){throw i.onloadeddata=null,i.onerror=null,new Error('Failed to download "'+e+'" as a sound')},i.src=e,i.loop=!0,i.load()):setTimeout(function(){t({play:function(){if(n)throw new Error("This SprigganMusic has been disposed of")},resume:function(){if(n)throw new Error("This SprigganMusic has been disposed of")},pause:function(){if(n)throw new Error("This SprigganMusic has been disposed of")},stop:function(){if(n)throw new Error("This SprigganMusic has been disposed of")}})},0),function(){n=!0,i&&i.pause()}}function SprigganMakeConstructable(e,t){e.prototype.construct=function(){for(var e=0;e<this.onConstruction.length;e++)this.onConstruction[e].call(this,this)},e.prototype.onConstruction=[],t&&e.onConstruction.push(t)}function SprigganMakeDisposable(e,t){e.prototype.disposed=!1,e.prototype.onDisposal=[],t&&e.prototype.onDisposal.push(t),e.prototype.dispose=function(){if(!this.disposed){this.disposed=!0;for(var e=0;e<this.onDisposal.length;e++)this.onDisposal[e].call(this,this)}}}function SprigganMakeElementWrapper(e){e.prototype.onConstruction.push(function(){this.element=document.createElement("DIV"),this.element.style.pointerEvents="none"}),e.prototype.onDisposal.push(function(){this.element.parentNode.removeChild(this.element)})}function SprigganMakeChild(e){e.prototype.onConstruction.push(function(){this.parent.children.push(this),this.parent.element.appendChild(this.element)}),e.prototype.onDisposal.push(function(){SprigganRemoveByValue(this.parent.children,this)})}function SprigganMakeParent(e){e.prototype.onConstruction.push(function(){this.children=[]}),e.prototype.onPausing.push(function(){for(var e=0;e<this.children.length;e++)this.children[e].pause()}),e.prototype.onResuming.push(function(){for(var e=0;e<this.children.length;e++)this.children[e].resume()}),e.prototype.onDisposal.push(function(){for(;this.children.length;)this.children[0].dispose()})}function SprigganMakeHideable(e){e.prototype.onConstruction.push(function(){this.hidden=!1}),e.prototype.hide=function(){this.element.style.visibility="hidden",this.hidden=!0},e.prototype.show=function(){this.element.style.visibility="visible",this.hidden=!1}}function SprigganMakePausable(e,t,n){e.prototype.onPausing=[],e.prototype.onResuming=[],t&&e.prototype.onPausing.push(t),n&&e.prototype.onResuming.push(n),e.prototype.onConstruction.push(function(){this.parent?this.paused=this.parent.paused:this.paused=!1}),e.prototype.onDisposing=function(){this.pause()},e.prototype.pause=function(){this.paused=!0;for(var e=0;e<this.onPausing.length;e++)this.onPausing[e].call(this,this)},e.prototype.resume=function(){this.paused=!1;for(var e=0;e<this.onResuming.length;e++)this.onResuming[e].call(this,this)}}function SprigganMakeClickable(e){e.prototype.onConstruction.push(function(){var e=this;e.clicked&&(e.element.onclick=function(){try{SprigganEventWasTriggeredByUserInteraction=!0,e.clicked()}finally{SprigganEventWasTriggeredByUserInteraction=!1}})})}function SprigganMakeMovable(e){e.prototype.onConstruction.push(function(){this.move(0,0)}),e.prototype.onPausing.push(function(){this.movement&&this.movement.pause()}),e.prototype.onResuming.push(function(){this.movement&&this.movement.resume()}),e.prototype.move=function(e,t){this.movement&&(this.movement.pause(),this.movement=null),"transform"in this.element.style?(this.element.style.transition="initial",this.element.style.transform="translate("+e+"em, "+t+"em)"):(this.element.style.left=e+"em",this.element.style.top=t+"em"),this.x=function(){return e},this.y=function(){return t}},e.prototype.moveOverSeconds=function(e,t,n,i){function o(){r.element.style.left=l()+"em",r.element.style.top=g()+"em"}var r=this;r.movement&&r.movement.pause();var a,s=r.x(),p=r.y(),l=r.x=function(){return s+(e-s)*a.progress()},g=r.y=function(){return p+(t-p)*a.progress()};"transform"in this.element.style?(r.element.offsetHeight,a=r.movement=new SprigganTimer(n,{completed:i,paused:function(){r.element.style.transition="initial",r.element.style.transform="translate("+l()+"em, "+g()+"em)"},resumed:function(){r.element.style.transition="transform "+(n-a.elapsedSeconds())+"s linear",r.element.style.transform="translate("+e+"em, "+t+"em)"}})):a=r.movement=new SprigganTimer(n,{completed:function(){r.element.style.left=e+"em",r.element.style.top=t+"em",i&&i()},paused:o,progress:o}),r.paused||a.resume()},e.prototype.moveAtPixelsPerSecond=function(e,t,n,i){this.movement&&this.movement.pause();var o=this.x(),r=this.y(),a=Math.sqrt((e-o)*(e-o)+(t-r)*(t-r));this.moveOverSeconds(e,t,a/n,i)}}function SprigganViewport(e,t,n,i,o){this.width=e,this.height=t,this.horizontalAlignment=n,this.verticalAlignment=i,this.clicked=o,this.construct(),this.element.style.position="absolute",this.element.style.width=e+"em",this.element.style.height=t+"em",this.element.style.overflow="hidden",document.body.appendChild(this.element),this.resize(),SprigganAllViewports.push(this)}function SprigganGroup(e,t){this.parent=e,this.clicked=t,this.construct(),this.element.style.position="absolute"}function SprigganSprite(e,t,n,i){this.parent=e,this.clicked=i,this.construct(),this.element.style.position="absolute",this.element.style.overflow="hidden",this.spriteSheet=t.get(SprigganSpriteSheet,n),this.spriteSheet.sprites.push(this),this.imageElement=this.spriteSheet.image.cloneNode(!0),this.imageElement.style.pointerEvents="auto",this.element.appendChild(this.imageElement)}function SprigganWrite(e,t,n,i,o){for(var r=new SprigganGroup(e),a=0,s=0,p=0;p<o.length;p++){var l=o.charAt(p);if("\n"!=l){if(/^[^\s]$/.test(l)){var g=new SprigganSprite(r,t,n);g.loop(l),g.move(a,s)}a+=i.kerning[l]?i.kerning[l]:i.kerning["default"]}else a=0,s+=i.lineSpacing}return r}window.onerror=function(){alert.apply(window,arguments);var e=document.getElementById("loading");for(e&&document.body.removeChild(e);SprigganAllContentManagers.length;)SprigganAllContentManagers[0].dispose()},SprigganSetLoadingText("Now loading scripts..."),window.onload=function(){SprigganSetLoadingText("Now loading content..."),document.body.style.transition="background 0.5s linear, color 0.5s linear",document.body.style.color="white",document.body.style.background="black",document.body.style.overflow="hidden",document.body.ondragstart=function(){return!1},document.onselectstart=function(){return!1},document.body.style.MozUserSelect="none";var e,t=new SprigganContentManager({progress:function(e,t){SprigganSetLoadingText("Now loading content... ("+e+"/"+t+")")},loaded:function(){document.body.removeChild(document.getElementById("loading")),e.call(t,t)}});e=SprigganBoot.call(t,t)},SprigganEventOnce.prototype.raise=function(){if(null===this.raised)for(this.raised=arguments;this.callbacks.length;)this.callbacks.pop().apply(null,this.raised)},SprigganEventOnce.prototype.listen=function(e){null!==this.raised?e.apply(null,this.raised):this.callbacks.push(e)},SprigganEventRecurring.prototype.raise=function(){var e=arguments,t=this.oneTimeCallbacks;this.oneTimeCallbacks=[];for(var n=0;n<this.callbacks.length;n++)this.callbacks[n].apply(null,e);for(var n=0;n<t.length;n++)t[n].apply(null,e)},SprigganEventRecurring.prototype.listen=function(e){this.callbacks.push(e)},SprigganEventRecurring.prototype.listenOnce=function(e){this.oneTimeCallbacks.push(e)},SprigganEventRecurring.prototype.unlisten=function(e){SprigganRemoveByValue(this.callbacks,e),SprigganRemoveByValue(this.oneTimeCallbacks,e)},SprigganTimer.prototype.pause=function(){this.timeout&&(this.elapsed+=(new Date).getTime()-this.started,this.started=null,clearTimeout(this.timeout),this.timeout=null,this.interval&&(clearInterval(this.interval),this.interval=null),this.configuration.paused&&this.configuration.paused.call(this,this))},SprigganTimer.prototype.resume=function(){if(!this.timeout&&!this.done){var e=this;this.timeout=setTimeout(function(){e.done=!0,e.timeout=null,e.interval&&(clearInterval(e.interval),e.interval=null),e.configuration.completed&&e.configuration.completed.call(e,e)},this.milliseconds-this.elapsedMilliseconds()),this.configuration.progress&&(this.interval=setInterval(function(){e.configuration.progress.call(e,e)},50)),this.started=(new Date).getTime(),this.configuration.resumed&&this.configuration.resumed.call(this,this)}},SprigganTimer.prototype.elapsedMilliseconds=function(){return this.done?this.milliseconds:Math.min(this.milliseconds,this.elapsed+(this.timeout?(new Date).getTime()-this.started:0))},SprigganTimer.prototype.elapsedSeconds=function(){return this.elapsedMilliseconds()/1e3},SprigganTimer.prototype.progress=function(){return this.seconds?this.elapsedSeconds()/this.seconds:1};var SprigganAllContentManagers=[];SprigganMakeDisposable(SprigganContentManager,function(){for(SprigganRemoveByValue(SprigganAllContentManagers,this);this.content.length;){var e=this.content.pop();e.loaded&&e.dispose()}}),SprigganContentManager.prototype.find=function(e){if(this.disposed)throw new Error("This SprigganContentManager has been disposed of");for(var t=0;t<this.content.length;t++){var n=this.content[t];if(n.url==e)return n}return null},SprigganContentManager.prototype.get=function(e,t){var n=this.find(t);if(this.completed!=this.total)throw new Error("This ContentManager has not finished loading");if(!n)throw new Error('No content named "'+t+'" was loaded into this SprigganContentManager');if(n.type!=e)throw new Error('Content "'+t+'" was loaded as a "'+n.type.name+'", but was accessed as a "'+e.name+'"');return n.value},SprigganContentManager.prototype.add=function(e,t){var n=this.find(t);if(this.completed)throw new Error("Cannot add content to a SprigganContentManager once content has loaded");if(n){if(n.type!=e)throw new Error('Content "'+t+'" was first loaded as a "'+n.type.name+'", but was loaded again as a "'+e.name+'"')}else{this.total++;var i=this,o={url:t,type:e,dispose:e(t,function(e){i.completed++,o.loaded=!0,i.disposed?o.dispose():(o.value=e,i.configuration.progress&&i.configuration.progress.call(i,i.completed,i.total,i),i.completed==i.total&&i.configuration.loaded&&i.configuration.loaded.call(i,i))})};this.content.push(o)}};var SprigganEventWasTriggeredByUserInteraction=!1,SprigganAllViewports=[];window.onresize=function(){for(var e=0;e<SprigganAllViewports.length;e++)SprigganAllViewports[e].resize()},SprigganViewport.prototype.resize=function(){var e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,t=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;switch(this.element.style.fontSize=Math.min(e/this.width,t/this.height)+"px",this.horizontalAlignment){case"left":this.element.style.left="0px";break;case"right":this.element.style.left=e-this.element.clientWidth+"px";break;default:this.element.style.left=(e-this.element.clientWidth)/2+"px"}switch(this.verticalAlignment){case"top":this.element.style.top="0px";break;case"bottom":this.element.style.top=t-this.element.clientHeight+"px";break;default:this.element.style.top=(t-this.element.clientHeight)/2+"px"}},SprigganMakeConstructable(SprigganViewport),SprigganMakeDisposable(SprigganViewport,function(){SprigganRemoveByValue(SprigganAllViewports,this)}),SprigganMakePausable(SprigganViewport),SprigganMakeParent(SprigganViewport),SprigganMakeElementWrapper(SprigganViewport),SprigganMakeHideable(SprigganViewport),SprigganMakeClickable(SprigganViewport),SprigganMakeConstructable(SprigganGroup),SprigganMakeDisposable(SprigganGroup),SprigganMakePausable(SprigganGroup),SprigganMakeElementWrapper(SprigganGroup),SprigganMakeHideable(SprigganGroup),SprigganMakeParent(SprigganGroup),SprigganMakeChild(SprigganGroup),SprigganMakeClickable(SprigganGroup),SprigganMakeMovable(SprigganGroup),SprigganMakeConstructable(SprigganSprite),SprigganMakeDisposable(SprigganSprite,function(){SprigganRemoveByValue(this.spriteSheet.sprites,this)}),SprigganMakePausable(SprigganSprite,function(){this.animation&&this.animation.pause()},function(){this.animation&&this.animation.resume()}),SprigganMakeElementWrapper(SprigganSprite),SprigganMakeHideable(SprigganSprite),SprigganMakeChild(SprigganSprite),SprigganMakeClickable(SprigganSprite),SprigganMakeMovable(SprigganSprite),SprigganSprite.prototype.setFrame=function(e){this.imageElement.style.left=e.imageLeft,this.imageElement.style.top=e.imageTop,this.element.style.width=e.wrapperWidth,this.element.style.height=e.wrapperHeight,this.element.style.marginLeft=e.wrapperMarginLeft,this.element.style.marginTop=e.wrapperMarginTop},SprigganSprite.prototype.play=function(e,t){function n(){if(r==o.length)return void(t&&t());var e=o[r++];i.setFrame(e),i.animation=new SprigganTimer(e.duration,{completed:n}),i.paused||i.animation.resume()}var i=this;i.animation&&i.animation.pause();var o=i.spriteSheet.getAnimationByName(e),r=0;n()},SprigganSprite.prototype.loop=function(e){function t(){n.play(e,t)}var n=this;n.animation&&n.animation.pause();var i=n.spriteSheet.getAnimationByName(e);1==i.length?n.setFrame(i[0]):t()};