var Shaders = {
    vertex: [
        "#ifdef GL_ES", 
        "precision mediump float;",
        "#endif",
        "attribute vec3 location;",
        "attribute vec2 uv;",
        "attribute vec3 color;",
        "attribute float exponent;",
        "varying vec2 var_uv;",
        "varying vec3 var_color;",
        "varying float var_exponent;",
        "uniform mat4 oldTransform;",
        "uniform mat4 newTransform;",
        "uniform vec2 aspect;",
        "uniform float pitch;",
        "uniform float roll;",
        "uniform float yaw;",
        "uniform float bank;",
        "vec3 applyDistortion(vec3 loc) {",
            "loc.xy *= mat2(cos(bank), -sin(bank), sin(bank), cos(bank));",
            "loc.xy *= mat2(cos(loc.z * roll), -sin(loc.z * roll), sin(loc.z * roll), cos(loc.z * roll));",
            "loc.xz *= mat2(cos(loc.z * yaw), -sin(loc.z * yaw), sin(loc.z * yaw), cos(loc.z * yaw));",
            "loc.yz *= mat2(cos(loc.z * pitch), sin(loc.z * pitch), -sin(loc.z * pitch), cos(loc.z * pitch));",
            "return loc;",
        "}",
        "vec3 applyTransform(mat4 transform) {",
            "return (vec4(location, 1.0) * transform).xyz;",
        "}",
        "void main() {",
            "vec3 oldLocation = applyDistortion(applyTransform(oldTransform));",
            "vec3 newLocation = applyDistortion(applyTransform(newTransform));",
            "vec2 norm = normalize(newLocation.xy / newLocation.z - oldLocation.xy / oldLocation.z);",
            "vec2 uv2 = sign(uv);",
            "vec2 uv3 = uv2 * 0.5 + 0.5;",
            "gl_Position = vec4(aspect * (mix(oldLocation.xy, newLocation.xy, uv3.y) + uv.x * norm.yx * vec2(1.0, -1.0) + uv.y * norm), 0.0, mix(oldLocation.z, newLocation.z, uv3.y));",
            "var_uv = uv2;",
            "var_color = color;",
            "var_exponent = exponent;",
        "}"
    ].join("\n"),
    fragment: [
        "#ifdef GL_ES", 
        "precision mediump float;",
        "#endif",
        "varying vec2 var_uv;",
        "varying vec3 var_color;",
        "varying float var_exponent;",
        "void main() {",
            "float intensity = pow(1.0 - min(length(var_uv), 1.0), var_exponent);",
            "gl_FragColor = vec4(intensity * var_color, 1.0);",
        "}"
    ].join("\n")
}